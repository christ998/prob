{"ast":null,"code":"import _toConsumableArray from \"C:\\\\Users\\\\Christian\\\\WebstormProjects\\\\teleodontoweb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"C:\\\\Users\\\\Christian\\\\WebstormProjects\\\\teleodontoweb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\Christian\\\\WebstormProjects\\\\teleodontoweb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"C:\\\\Users\\\\Christian\\\\WebstormProjects\\\\teleodontoweb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\Christian\\\\WebstormProjects\\\\teleodontoweb\\\\src\\\\views\\\\pages\\\\patient\\\\extra-oral.js\";\n\nimport React, { useState, useEffect, Suspense } from 'react';\nimport Axios from '../../../helpers/axiosConfig';\nimport { Button, ButtonGroup, ButtonToolbar, Tooltip } from 'reactstrap';\nimport AddExtraOralForm from '../../../components/Fantoma/FormsExams/AddExtraOralForm';\nimport EditExtraOralForm from '../../../components/Fantoma/FormsExams/EditExtraOralForm';\nimport MarkersGroupExtraOral from '../../../components/Fantoma/Tag/MarkersGroupExtraOral';\nimport { Canvas } from \"react-three-fiber\";\nimport CameraControls from '../../../components/Fantoma/CameraControls';\nimport MouseHelper from '../../../components/Fantoma/MouseHelper';\nimport FantomaExtraOral from '../../../components/Fantoma/FantomaExtraOral';\nimport { Link } from 'react-router-dom';\n\nvar ExtraOral = function ExtraOral(_ref) {\n  var _location$state, _location$state2, _location$state3, _location$state4, _location$state5, _location$state6, _location$state7, _location$state8, _location$state9, _location$state10, _location$state11, _location$state12, _location$state13, _location$state14;\n\n  var location = _ref.location;\n\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      positionHelper = _useState2[0],\n      setPositionHelper = _useState2[1];\n\n  var _useState3 = useState({\n    height: undefined\n  }),\n      _useState4 = _slicedToArray(_useState3, 2),\n      canvasSize = _useState4[0],\n      setCanvasSize = _useState4[1];\n\n  var _useState5 = useState(null),\n      _useState6 = _slicedToArray(_useState5, 2),\n      rSelected = _useState6[0],\n      setRSelected = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      visibilityHelper = _useState8[0],\n      setVisibilityHelper = _useState8[1];\n\n  var initialFormState = {\n    id: null,\n    idAnamnesis: null,\n    inspection: '',\n    palpation: '',\n    position_x: null,\n    position_y: null,\n    position_z: null\n  };\n\n  var getPositionHelper = function getPositionHelper(positionHelper) {\n    setPositionHelper(positionHelper);\n  };\n\n  var _useState9 = useState([]),\n      _useState10 = _slicedToArray(_useState9, 2),\n      markers = _useState10[0],\n      setMarkers = _useState10[1];\n\n  var _useState11 = useState(initialFormState),\n      _useState12 = _slicedToArray(_useState11, 2),\n      currentMarker = _useState12[0],\n      setCurrentMarker = _useState12[1];\n\n  var _useState13 = useState(false),\n      _useState14 = _slicedToArray(_useState13, 2),\n      adding = _useState14[0],\n      setAdding = _useState14[1];\n\n  var _useState15 = useState(false),\n      _useState16 = _slicedToArray(_useState15, 2),\n      editing = _useState16[0],\n      setEditing = _useState16[1];\n\n  var _useState17 = useState(false),\n      _useState18 = _slicedToArray(_useState17, 2),\n      addTooltipOpen = _useState18[0],\n      setAddTooltipOpen = _useState18[1];\n\n  var _useState19 = useState(false),\n      _useState20 = _slicedToArray(_useState19, 2),\n      editTooltipOpen = _useState20[0],\n      setEditTooltipOpen = _useState20[1];\n\n  var addToggle = function addToggle() {\n    return setAddTooltipOpen(!addTooltipOpen);\n  };\n\n  var editToggle = function editToggle() {\n    return setEditTooltipOpen(!editTooltipOpen);\n  };\n\n  var getMarkers = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var newMarkers, res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              newMarkers = [];\n              _context.next = 3;\n              return Axios.get(\"extra-oral-exam/\" + location.state.anamId).then(function (response) {\n                setMarkers([]);\n                response.data.result.forEach(function (element) {\n                  newMarkers.push({\n                    id: element.extra_oral_exam_id,\n                    idAnamnesis: location.state.anamId,\n                    inspection: element.inspection,\n                    palpation: element.palpation,\n                    position_x: element.position_x,\n                    position_y: element.position_y,\n                    position_z: element.position_z\n                  });\n                  setMarkers([].concat(newMarkers));\n                });\n              });\n\n            case 3:\n              res = _context.sent;\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function getMarkers() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var helperAddMarker = function helperAddMarker() {\n    if (rSelected === 1) {\n      setAdding(true);\n    }\n  };\n\n  var addMarker = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(marker) {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (!(rSelected === 1)) {\n                _context2.next = 7;\n                break;\n              }\n\n              setAdding(true);\n              _context2.next = 4;\n              return Axios.post(\"extra-oral-exam\", {\n                dentalAnamnesisId: location.state.anamId,\n                inspection: marker.inspection,\n                palpation: marker.palpation,\n                position_x: positionHelper.x,\n                position_y: positionHelper.y,\n                position_z: positionHelper.z\n              });\n\n            case 4:\n              res = _context2.sent;\n              if (!res.data.error) //alert(\"Etiqueta guardada\")\n                setMarkers([].concat(_toConsumableArray(markers), [marker]));\n              getMarkers();\n\n            case 7:\n              setAdding(false);\n\n            case 8:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function addMarker(_x) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var updateMarker = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id, updatedMarker) {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              setEditing(false);\n              _context3.next = 3;\n              return Axios.put(\"extra-oral-exam\", {\n                dentalAnamnesisId: location.state.anamId,\n                inspection: updatedMarker.inspection,\n                palpation: updatedMarker.palpation,\n                observation: updatedMarker.observation,\n                position_x: updatedMarker.position_x,\n                position_y: updatedMarker.position_y,\n                position_z: updatedMarker.position_z,\n                extraOralExamId: id\n              });\n\n            case 3:\n              res = _context3.sent;\n\n              if (!res.data.error) {\n                setMarkers(markers.map(function (marker) {\n                  return marker.id === id ? updatedMarker : marker;\n                }));\n                getMarkers(); //alert(\"Etiqueta guardada\")\n              }\n\n            case 5:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function updateMarker(_x2, _x3) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var editMarker = function editMarker(marker) {\n    setEditing(true);\n    setCurrentMarker({\n      id: marker.id,\n      idAnamnesis: marker.idAnamnesis,\n      inspection: marker.inspection,\n      palpation: marker.palpation,\n      position_x: marker.position_x,\n      position_y: marker.position_y,\n      position_z: marker.position_z\n    });\n  };\n\n  var deleteMarker = /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(id) {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              setEditing(false);\n              _context4.next = 3;\n              return Axios.delete(\"extra-oral-exam/\" + id);\n\n            case 3:\n              res = _context4.sent;\n\n              if (!res.data.error) {\n                setMarkers(markers.filter(function (marker) {\n                  return marker.id !== id;\n                }));\n                getMarkers(); //alert(\"Etiqueta eliminada\")\n              }\n\n            case 5:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function deleteMarker(_x4) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    var navbarSize = document.getElementsByClassName('navbar-top')[0];\n    var footerSize = document.getElementsByClassName('footer')[0];\n\n    var handleResize = function handleResize() {\n      setCanvasSize({\n        width: window.innerWidth - navbarSize.offsetWidth - footerSize.offsetWidth,\n        height: window.innerHeight - navbarSize.offsetHeight - footerSize.offsetHeight\n      });\n    };\n\n    window.addEventListener(\"resize\", handleResize);\n    handleResize();\n    getMarkers();\n    return function () {\n      return window.removeEventListener(\"resize\", handleResize);\n    };\n  }, []);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(ButtonToolbar, {\n    style: {\n      zIndex: 100,\n      position: 'absolute',\n      top: '90%',\n      left: '50%',\n      transform: 'translate(-50%, -50%)'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(ButtonGroup, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    color: \"primary\",\n    size: \"lg\",\n    onClick: function onClick() {\n      return setRSelected(1);\n    },\n    active: rSelected === 1,\n    id: \"add\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fas fa-tags\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 105\n    }\n  })), /*#__PURE__*/React.createElement(Tooltip, {\n    placement: \"top\",\n    isOpen: addTooltipOpen,\n    target: \"add\",\n    toggle: addToggle,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 21\n    }\n  }, \"A\\xF1adir etiqueta\"), /*#__PURE__*/React.createElement(Button, {\n    color: \"primary\",\n    size: \"lg\",\n    onClick: function onClick() {\n      return setRSelected(2);\n    },\n    active: rSelected === 2,\n    id: \"edit\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"ni ni-active-40\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 106\n    }\n  })), /*#__PURE__*/React.createElement(Tooltip, {\n    placement: \"top\",\n    isOpen: editTooltipOpen,\n    target: \"edit\",\n    toggle: editToggle,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 17\n    }\n  }, \"Editar etiqueta\"))), /*#__PURE__*/React.createElement(ButtonGroup, {\n    style: {\n      zIndex: 100,\n      position: 'absolute',\n      top: '90%',\n      left: '95%',\n      transform: 'translate(-100%, -50%)'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    color: \"primary\",\n    active: true,\n    size: \"lg\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 17\n    }\n  }, \"Extra Oral\"), /*#__PURE__*/React.createElement(Button, {\n    color: \"primary\",\n    size: \"lg\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    style: {\n      color: \"white\"\n    },\n    to: {\n      state: {\n        id: location === null || location === void 0 ? void 0 : (_location$state = location.state) === null || _location$state === void 0 ? void 0 : _location$state.id,\n        run: location === null || location === void 0 ? void 0 : (_location$state2 = location.state) === null || _location$state2 === void 0 ? void 0 : _location$state2.run,\n        name: location === null || location === void 0 ? void 0 : (_location$state3 = location.state) === null || _location$state3 === void 0 ? void 0 : _location$state3.name,\n        apellido: location === null || location === void 0 ? void 0 : (_location$state4 = location.state) === null || _location$state4 === void 0 ? void 0 : _location$state4.apellido,\n        anamId: location === null || location === void 0 ? void 0 : (_location$state5 = location.state) === null || _location$state5 === void 0 ? void 0 : _location$state5.anamId\n      },\n      pathname: \"/admin/soft-tissues-exam\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 51\n    }\n  }, \"Tejidos Blandos\")), /*#__PURE__*/React.createElement(Button, {\n    color: \"primary\",\n    size: \"lg\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    style: {\n      color: \"white\"\n    },\n    to: {\n      state: {\n        id: location === null || location === void 0 ? void 0 : (_location$state6 = location.state) === null || _location$state6 === void 0 ? void 0 : _location$state6.id,\n        run: location === null || location === void 0 ? void 0 : (_location$state7 = location.state) === null || _location$state7 === void 0 ? void 0 : _location$state7.run,\n        name: location === null || location === void 0 ? void 0 : (_location$state8 = location.state) === null || _location$state8 === void 0 ? void 0 : _location$state8.name,\n        apellido: location === null || location === void 0 ? void 0 : (_location$state9 = location.state) === null || _location$state9 === void 0 ? void 0 : _location$state9.apellido,\n        anamId: location === null || location === void 0 ? void 0 : (_location$state10 = location.state) === null || _location$state10 === void 0 ? void 0 : _location$state10.anamId\n      },\n      pathname: \"/admin/odontogram\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 51\n    }\n  }, \"Odontograma\")), /*#__PURE__*/React.createElement(Button, {\n    color: \"info\",\n    size: \"lg\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    style: {\n      color: \"white\"\n    },\n    to: {\n      state: {\n        id: location === null || location === void 0 ? void 0 : (_location$state11 = location.state) === null || _location$state11 === void 0 ? void 0 : _location$state11.id,\n        run: location === null || location === void 0 ? void 0 : (_location$state12 = location.state) === null || _location$state12 === void 0 ? void 0 : _location$state12.run,\n        name: location === null || location === void 0 ? void 0 : (_location$state13 = location.state) === null || _location$state13 === void 0 ? void 0 : _location$state13.name,\n        apellido: location === null || location === void 0 ? void 0 : (_location$state14 = location.state) === null || _location$state14 === void 0 ? void 0 : _location$state14.apellido\n      },\n      pathname: \"/admin/clinical-record\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 48\n    }\n  }, \"Volver\"))), editing ? /*#__PURE__*/React.createElement(EditExtraOralForm, {\n    editing: editing,\n    setEditing: setEditing,\n    currentMarker: currentMarker,\n    updateMarker: updateMarker,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 17\n    }\n  }) : /*#__PURE__*/React.createElement(AddExtraOralForm, {\n    adding: adding,\n    setAdding: setAdding,\n    addMarker: addMarker,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(Canvas, {\n    className: \"canvas\",\n    gl: {\n      antialias: true\n    },\n    shadowMap: true,\n    pixelRatio: window.devicePixelRatio,\n    style: {\n      height: canvasSize.height,\n      cursor: visibilityHelper ? 'crosshair' : 'default'\n    },\n    camera: {\n      fov: 55,\n      position: [0, 0, 10]\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(CameraControls, {\n    minDistance: 1.3,\n    maxDistance: 3.5,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 5\n    }\n  }), /*#__PURE__*/React.createElement(\"spotLight\", {\n    intensity: 0.4,\n    position: [300, 300, 2000],\n    castShadow: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 244,\n      columnNumber: 5\n    }\n  }), /*#__PURE__*/React.createElement(\"spotLight\", {\n    intensity: 0.35,\n    position: [-3000, 1300, -1000],\n    castShadow: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 5\n    }\n  }), /*#__PURE__*/React.createElement(\"ambientLight\", {\n    intensity: 0.07,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 5\n    }\n  }), /*#__PURE__*/React.createElement(Suspense, {\n    fallback: \"loading\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 5\n    }\n  }, rSelected === 1 ? /*#__PURE__*/React.createElement(MouseHelper, {\n    visibility: visibilityHelper,\n    handlePosition: getPositionHelper,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 36\n    }\n  }) : /*#__PURE__*/React.createElement(React.Fragment, null), /*#__PURE__*/React.createElement(FantomaExtraOral, {\n    scale: [10, 10, 10],\n    position: [0, 0, 0],\n    onDoubleClick: helperAddMarker,\n    onPointerOver: function onPointerOver() {\n      return setVisibilityHelper(true);\n    },\n    onPointerOut: function onPointerOut() {\n      return setVisibilityHelper(false);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 6\n    }\n  }), /*#__PURE__*/React.createElement(MarkersGroupExtraOral, {\n    markers: markers,\n    editMarker: editMarker,\n    deleteMarker: deleteMarker,\n    adding: rSelected,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 21\n    }\n  }))));\n};\n\nexport default ExtraOral;","map":{"version":3,"sources":["C:/Users/Christian/WebstormProjects/teleodontoweb/src/views/pages/patient/extra-oral.js"],"names":["React","useState","useEffect","Suspense","Axios","Button","ButtonGroup","ButtonToolbar","Tooltip","AddExtraOralForm","EditExtraOralForm","MarkersGroupExtraOral","Canvas","CameraControls","MouseHelper","FantomaExtraOral","Link","ExtraOral","location","positionHelper","setPositionHelper","height","undefined","canvasSize","setCanvasSize","rSelected","setRSelected","visibilityHelper","setVisibilityHelper","initialFormState","id","idAnamnesis","inspection","palpation","position_x","position_y","position_z","getPositionHelper","markers","setMarkers","currentMarker","setCurrentMarker","adding","setAdding","editing","setEditing","addTooltipOpen","setAddTooltipOpen","editTooltipOpen","setEditTooltipOpen","addToggle","editToggle","getMarkers","newMarkers","get","state","anamId","then","response","data","result","forEach","element","push","extra_oral_exam_id","res","helperAddMarker","addMarker","marker","post","dentalAnamnesisId","x","y","z","error","updateMarker","updatedMarker","put","observation","extraOralExamId","map","editMarker","deleteMarker","delete","filter","navbarSize","document","getElementsByClassName","footerSize","handleResize","width","window","innerWidth","offsetWidth","innerHeight","offsetHeight","addEventListener","removeEventListener","zIndex","position","top","left","transform","color","run","name","apellido","pathname","antialias","devicePixelRatio","cursor","fov"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, Suspense } from 'react'\r\nimport Axios from '../../../helpers/axiosConfig'\r\nimport { Button, ButtonGroup, ButtonToolbar, Tooltip } from 'reactstrap'\r\nimport AddExtraOralForm from '../../../components/Fantoma/FormsExams/AddExtraOralForm'\r\nimport EditExtraOralForm from '../../../components/Fantoma/FormsExams/EditExtraOralForm'\r\nimport MarkersGroupExtraOral from '../../../components/Fantoma/Tag/MarkersGroupExtraOral'\r\nimport { Canvas } from \"react-three-fiber\";\r\nimport CameraControls from '../../../components/Fantoma/CameraControls'\r\nimport MouseHelper  from '../../../components/Fantoma/MouseHelper'\r\nimport FantomaExtraOral  from '../../../components/Fantoma/FantomaExtraOral'\r\nimport { Link } from 'react-router-dom';\r\n\r\n\r\nconst ExtraOral = ({location}) => {\r\n\r\n    const [positionHelper, setPositionHelper]= useState()\r\n\r\n    const [canvasSize, setCanvasSize] = useState({height: undefined}); \r\n    const [rSelected, setRSelected] = useState(null);\r\n\r\n    const [visibilityHelper, setVisibilityHelper] = useState(false) \r\n    \r\n    const initialFormState = { \r\n        id: null, \r\n        idAnamnesis: null,\r\n        inspection: '',\r\n        palpation: '',\r\n        position_x: null,\r\n        position_y: null,\r\n        position_z: null        \r\n    }\r\n\r\n    const getPositionHelper = (positionHelper) => {\r\n        setPositionHelper(positionHelper)\r\n    }\r\n\r\n    const [markers, setMarkers] = useState([])\r\n    const [currentMarker, setCurrentMarker ] = useState(initialFormState)\r\n    const [adding, setAdding ] = useState(false)\r\n    const [editing, setEditing ] = useState(false)\r\n\r\n    const [addTooltipOpen, setAddTooltipOpen] = useState(false);\r\n    const [editTooltipOpen, setEditTooltipOpen] = useState(false);\r\n    const addToggle = () => setAddTooltipOpen(!addTooltipOpen);\r\n    const editToggle = () => setEditTooltipOpen(!editTooltipOpen);\r\n\r\n\r\n\r\n    const getMarkers = async () => {\r\n        const newMarkers = [] \r\n        const res = await Axios.get(\"extra-oral-exam/\" + location.state.anamId)\r\n        \r\n        .then(response => {\r\n            setMarkers([])\r\n            response.data.result.forEach(element => {\r\n                newMarkers.push({\r\n                    id: element.extra_oral_exam_id,\r\n                    idAnamnesis: location.state.anamId, \r\n                    inspection: element.inspection,\r\n                    palpation: element.palpation,\r\n                    position_x:element.position_x, \r\n                    position_y:element.position_y, \r\n                    position_z:element.position_z, \r\n                });  \r\n                setMarkers([...newMarkers])   \r\n            });\r\n        })  \r\n    }\r\n\r\n\r\n    const helperAddMarker = ()=>{\r\n        if(rSelected===1){\r\n            setAdding(true)\r\n        }\r\n    }\r\n\r\n\r\n    const addMarker = async (marker) => {\r\n        if(rSelected===1){\r\n            setAdding(true)\r\n            const res = await Axios.post(\"extra-oral-exam\",\r\n                {\r\n                    dentalAnamnesisId : location.state.anamId,\r\n                    inspection: marker.inspection,\r\n                    palpation: marker.palpation,\r\n                    position_x: positionHelper.x,\r\n                    position_y: positionHelper.y,\r\n                    position_z: positionHelper.z,\r\n                }\r\n\t\t    )\r\n            if (!res.data.error)\r\n                //alert(\"Etiqueta guardada\")\r\n                setMarkers([ ...markers, marker ])\r\n                getMarkers()\r\n        }\r\n        setAdding(false)\r\n\t}\r\n\r\n    const updateMarker = async (id, updatedMarker) => {\r\n        setEditing(false)\r\n        const res = await Axios.put(\"extra-oral-exam\",\r\n            {\r\n                dentalAnamnesisId : location.state.anamId,\r\n                inspection: updatedMarker.inspection,\r\n                palpation: updatedMarker.palpation,\r\n                observation: updatedMarker.observation,\r\n                position_x: updatedMarker.position_x,\r\n                position_y: updatedMarker.position_y,\r\n                position_z: updatedMarker.position_z,\r\n                extraOralExamId: id\r\n            }\r\n        )\r\n        if (!res.data.error){\r\n\t\t    setMarkers(markers.map(marker => (marker.id === id ? updatedMarker : marker)))\r\n            getMarkers()\r\n            //alert(\"Etiqueta guardada\")\r\n        }\r\n\t}\r\n\r\n    const editMarker = marker => {\r\n\t\tsetEditing(true)\r\n        setCurrentMarker({ \r\n            id: marker.id, \r\n            idAnamnesis: marker.idAnamnesis,\r\n            inspection: marker.inspection,\r\n            palpation: marker.palpation,\r\n            position_x: marker.position_x,\r\n            position_y: marker.position_y,\r\n            position_z: marker.position_z\r\n        })\r\n    }\r\n\r\n    const deleteMarker = async (id) => {\r\n\r\n        setEditing(false)\r\n        const res = await Axios.delete(\"extra-oral-exam/\" + id);\r\n        if (!res.data.error) {\r\n            setMarkers(markers.filter(marker => marker.id !== id))\r\n            getMarkers()\r\n            //alert(\"Etiqueta eliminada\")\r\n        }\r\n    }\r\n    \r\n\r\n    useEffect(() => {\r\n\t\tconst navbarSize = document.getElementsByClassName('navbar-top')[0];\r\n\t\tconst footerSize = document.getElementsByClassName('footer')[0];\r\n\t\tconst handleResize = () => {\r\n\t\t\tsetCanvasSize({\r\n\t\t\t\twidth: window.innerWidth - navbarSize.offsetWidth - footerSize.offsetWidth,\r\n\t\t\t\theight: window.innerHeight - navbarSize.offsetHeight - footerSize.offsetHeight\r\n\t\t\t});\r\n\t\t}\r\n\t\twindow.addEventListener(\"resize\", handleResize);\r\n        handleResize();\r\n        \r\n        getMarkers()\r\n        return () => window.removeEventListener(\"resize\", handleResize); \r\n\t}, []);\r\n    \r\n\r\n    return (\r\n        <>\r\n        <ButtonToolbar style={{ zIndex: 100, position: 'absolute', top:'90%', left:'50%', transform:'translate(-50%, -50%)' }}>\r\n            <ButtonGroup>\r\n\t\t\t\t<Button color=\"primary\" size=\"lg\" onClick={() => setRSelected(1)} active={rSelected === 1} id=\"add\"><i className=\"fas fa-tags\" ></i></Button>\r\n                    <Tooltip\r\n                        placement=\"top\"\r\n                        isOpen={addTooltipOpen}\r\n                        target={\"add\"}\r\n                        toggle={addToggle}\r\n                    >\r\n                        AÃ±adir etiqueta\r\n                    </Tooltip>\r\n\t\t\t\t<Button color=\"primary\" size=\"lg\" onClick={() => setRSelected(2)} active={rSelected === 2} id=\"edit\"><i className=\"ni ni-active-40\" ></i></Button>\r\n                <Tooltip\r\n                        placement=\"top\"\r\n                        isOpen={editTooltipOpen}\r\n                        target={\"edit\"}\r\n                        toggle={editToggle}\r\n                    >\r\n                        Editar etiqueta\r\n                    </Tooltip>\r\n\t\t\t</ButtonGroup>\r\n        </ButtonToolbar>\r\n            <ButtonGroup style={{ zIndex: 100, position: 'absolute', top:'90%', left:'95%', transform:'translate(-100%, -50%)' }}>\r\n                <Button color=\"primary\" active size=\"lg\">Extra Oral</Button>\r\n                <Button color=\"primary\" size=\"lg\"><Link style={{color: \"white\"}} to={{\r\n                    state: {\r\n                        id: location?.state?.id,\r\n                        run: location?.state?.run,\r\n                        name: location?.state?.name,\r\n                        apellido: location?.state?.apellido,\r\n                        anamId: location?.state?.anamId\r\n                    },\r\n                    pathname: \"/admin/soft-tissues-exam\"\r\n                    }}>Tejidos Blandos</Link>\r\n                </Button>\r\n                <Button color=\"primary\" size=\"lg\"><Link style={{color: \"white\"}} to={{\r\n                    state: {\r\n                        id: location?.state?.id,\r\n                        run: location?.state?.run,\r\n                        name: location?.state?.name,\r\n                        apellido: location?.state?.apellido,\r\n                        anamId: location?.state?.anamId\r\n                    },\r\n                    pathname: \"/admin/odontogram\"\r\n                    }}>Odontograma</Link>\r\n                </Button>\r\n                <Button color=\"info\" size=\"lg\"><Link style={{color: \"white\"}} to={{\r\n                    state: {\r\n                        id: location?.state?.id,\r\n                        run: location?.state?.run,\r\n                        name: location?.state?.name,\r\n                        apellido: location?.state?.apellido\r\n                    },\r\n                    pathname: \"/admin/clinical-record\"\r\n                    }}>Volver</Link>\r\n                </Button>\r\n            </ButtonGroup>\r\n\r\n            {editing ? (\r\n                <EditExtraOralForm\r\n                    editing={editing}\r\n                    setEditing={setEditing}\r\n                    currentMarker={currentMarker}\r\n                    updateMarker={updateMarker}\r\n                />\r\n            ) : (\r\n                <AddExtraOralForm\r\n                    adding={adding}\r\n                    setAdding={setAdding} \r\n                    addMarker={addMarker} \r\n                />\r\n            )}\r\n            <Canvas className=\"canvas\"\r\n\t\t\t\tgl={{ antialias: true }}\r\n\t\t\t\tshadowMap\r\n\t\t\t\tpixelRatio={window.devicePixelRatio}\r\n\t\t\t\tstyle={{ height: canvasSize.height, cursor: visibilityHelper ? ('crosshair'):('default') }}\r\n\t\t\t\tcamera={{ fov: 55, position: [0, 0, 10] }}\r\n\t\t\t>\r\n\t\t\t\t<CameraControls minDistance={1.3} maxDistance={3.5}/>\r\n\t\t\t\t<spotLight intensity={0.4} position={[300, 300, 2000]} castShadow={true} />\r\n\t\t\t\t<spotLight intensity={0.35} position={[-3000, 1300, -1000]} castShadow={true} />\r\n\t\t\t\t<ambientLight intensity={0.07} />\r\n\t\t\t\t<Suspense fallback=\"loading\">\r\n                {rSelected === 1 ?(<MouseHelper visibility={visibilityHelper} handlePosition={getPositionHelper}/>):(<></>)}\r\n\t\t\t\t\t<FantomaExtraOral scale={[10, 10, 10]} position={[0, 0, 0]} onDoubleClick={helperAddMarker} onPointerOver={() => setVisibilityHelper(true)} onPointerOut={() => setVisibilityHelper(false)}/>\r\n                    <MarkersGroupExtraOral markers={markers} editMarker={editMarker} deleteMarker={deleteMarker} adding={rSelected} />\t\r\n\t\t\t\t</Suspense>\r\n\t\t\t\t{/* <Stats /> */}\r\n\t\t\t</Canvas>\r\n        </>\r\n    )\r\n}\r\nexport default ExtraOral"]},"metadata":{},"sourceType":"module"}