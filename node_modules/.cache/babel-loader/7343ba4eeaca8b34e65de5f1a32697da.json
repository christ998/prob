{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\Christian\\\\Desktop\\\\tele\\\\Nueva carpeta\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\Christian\\\\Desktop\\\\tele\\\\Nueva carpeta\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\Christian\\\\Desktop\\\\tele\\\\Nueva carpeta\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef}from'react';import{Button,Col,Container,Form,FormGroup,Input,Row,InputGroup,InputGroupText,InputGroupAddon,Card,CardBody,Label}from'reactstrap';import classnames from\"classnames\";import CardHeader from'reactstrap/lib/CardHeader';import Axios from'../../../helpers/axiosConfig';import{Redirect}from'react-router-dom';import SimpleModal from\"../components/SimpleModal\";var Periodontogram=function Periodontogram(_ref){var location=_ref.location;var modalRef=useRef();var setModal=function setModal(options){modalRef.current.setModal(options);};var _useState=useState(false),_useState2=_slicedToArray(_useState,2),next=_useState2[0],setNext=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),periodontalDiagnosis=_useState4[0],setPeriodontalDiagnosis=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),odontologicalDiagnosis=_useState6[0],setOdontologicalDiagnosis=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),treatmentPlan=_useState8[0],setTreatmentPlan=_useState8[1];//LOCATION###############################################################\nuseEffect(function(){fetchFiles();},[]);//FILE###################################################################\nvar _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),fileName=_useState10[0],setFileName=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),fileType=_useState12[0],setFileType=_useState12[1];var _useState13=useState({}),_useState14=_slicedToArray(_useState13,2),file=_useState14[0],setFile=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),hasFile=_useState16[0],setHasFile=_useState16[1];var _useState17=useState([]),_useState18=_slicedToArray(_useState17,2),files=_useState18[0],setFiles=_useState18[1];var extAllowed=\"pdf\";var sizAllowed=10000000;var defaultHelpText=extAllowed+\" (max: \"+sizAllowed/1000000+\" MB)\";var _useState19=useState(defaultHelpText),_useState20=_slicedToArray(_useState19,2),helpText=_useState20[0],setHelpText=_useState20[1];var handleHasFile=function handleHasFile(){setHasFile(!hasFile);cleanFile();setHelpText(defaultHelpText);};var fetchFiles=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Axios.post(\"photo/odonto_geriatra/obtain\",{anamnId:location.state.anamId});case 2:res=_context.sent;if(!res.data.error){setFiles(res.data.result);setModal({});};case 5:case\"end\":return _context.stop();}}},_callee);}));return function fetchFiles(){return _ref2.apply(this,arguments);};}();var loadFile=function loadFile(file){var _file$;if((_file$=file[0])===null||_file$===void 0?void 0:_file$.name){var _file$2;var size=file[0].size;var full=(_file$2=file[0])===null||_file$2===void 0?void 0:_file$2.name;var type=full.slice((full.lastIndexOf('.')-1>>>0)+2).toLowerCase();if(extAllowed.indexOf(type)>=0){if(size<=sizAllowed){setFileName(full.slice(0,full.lastIndexOf('.')));setFileType(type);setFile(file);setHelpText(full);return;}else{cleanFile();setHelpText(\"Tamaño de archivo invalido\");return;};};cleanFile();setHelpText(\"Formato de archivo invalido\");};};var cleanFile=function cleanFile(){setFileName(\"\");setFileType(\"\");setFile({});};var uploadFile=function uploadFile(){if(fileName){var f=new FormData();f.append(\"file\",file[0],fileName+'.'+fileType);Axios.post(\"file/img_odonto/\"+location.state.run,f).then(function(response){saveFile();}).catch(function(error){console.log(error);});};};var saveFile=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return Axios.post(\"photo/odonto_geriatra\",{anamnId:location.state.anamId,nombreImagen:fileName+'.'+fileType,ruta:\"static/images_anam_odonto/\"+location.state.run});case 2:res=_context2.sent;if(!res.data.error){fetchFiles();cleanFile();setHelpText(defaultHelpText);setHasFile(false);};case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function saveFile(){return _ref3.apply(this,arguments);};}();var removeFile=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(fId,name){var res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return Axios.post(\"photo/odonto_geriatra/rm/\",{fId:fId,route:location.state.run+'/'+name});case 2:res=_context3.sent;if(!res.data.error){fetchFiles();};case 5:case\"end\":return _context3.stop();}}},_callee3);}));return function removeFile(_x,_x2){return _ref4.apply(this,arguments);};}();var addDiagnosticos=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(e){var res;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:e.preventDefault();_context4.next=3;return Axios.post(\"geriatrical-odonto-anamnesis/periodontograma\",{anamId:location.state.anamId,periodontalDiagnosis:periodontalDiagnosis,odontologicalDiagnosis:odontologicalDiagnosis,treatmentPlan:treatmentPlan});case 3:res=_context4.sent;if(!res.data.error){setNext(true);};case 6:case\"end\":return _context4.stop();}}},_callee4);}));return function addDiagnosticos(_x3){return _ref5.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(Container,null,/*#__PURE__*/React.createElement(SimpleModal,{ref:modalRef}),/*#__PURE__*/React.createElement(Card,null,/*#__PURE__*/React.createElement(CardBody,null,/*#__PURE__*/React.createElement(\"h3\",null,location.state.run,\", \",location.state.name,\" \",location.state.apellido),/*#__PURE__*/React.createElement(\"h1\",null,\"Anamnesis Odonto-geri\\xE1trica\"),/*#__PURE__*/React.createElement(\"h6\",{className:\"heading-small text-muted mb-4\"},\"Periodontograma\"),/*#__PURE__*/React.createElement(Form,{onSubmit:addDiagnosticos,role:\"form\"},/*#__PURE__*/React.createElement(FormGroup,{className:\"row\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Label,{className:\"form-control-label mb-3\"},\"Periodontograma (\",/*#__PURE__*/React.createElement(\"a\",{href:\"https://sepa.es/periodontograma/index.html\",target:\"_blank\"},\"Link a SEPA\"),\")\"))),/*#__PURE__*/React.createElement(FormGroup,{className:\"row\"},/*#__PURE__*/React.createElement(Col,{md:\"6\"},/*#__PURE__*/React.createElement(Label,{className:\"form-control-label mb-3\"},\"Archivos disponibles\"),files.map(function(file){return/*#__PURE__*/React.createElement(\"div\",{key:file.foto_id,className:\"list-group mb-2\"},/*#__PURE__*/React.createElement(InputGroup,null,/*#__PURE__*/React.createElement(Button,{className:\"mr-2\",color:\"danger\",size:\"sm\",outline:true,onClick:function onClick(){return setModal({title:'Confirmación',text:'Desea eliminar '+file.foto_nombre+'?',type:2,fx:function fx(){return removeFile(file.foto_id,file.foto_nombre);}});}},/*#__PURE__*/React.createElement(\"i\",{className:\"far fa-trash-alt\"})),/*#__PURE__*/React.createElement(\"a\",{rel:\"noopener noreferrer\",target:\"_blank\",href:process.env.REACT_APP_API_URL+\"\".concat(file.url)+\"/\"+\"\".concat(file.foto_nombre)},file.foto_nombre)));})),/*#__PURE__*/React.createElement(Col,{md:\"6\"},/*#__PURE__*/React.createElement(Card,null,/*#__PURE__*/React.createElement(CardHeader,null,/*#__PURE__*/React.createElement(FormGroup,{className:\"row\"},/*#__PURE__*/React.createElement(Col,{className:\"d-flex\"},/*#__PURE__*/React.createElement(Label,{className:\"form-control-label\"},\"\\xBFSubir periodontograma?\"),/*#__PURE__*/React.createElement(\"label\",{className:\"custom-toggle custom-toggle-info ml-3\"},/*#__PURE__*/React.createElement(Input,{type:\"checkbox\",checked:hasFile,onChange:function onChange(){return handleHasFile();}}),/*#__PURE__*/React.createElement(\"span\",{className:\"custom-toggle-slider rounded-circle\",\"data-label-off\":\"No\",\"data-label-on\":\"S\\xED\"}))))),hasFile&&/*#__PURE__*/React.createElement(CardBody,null,/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(InputGroup,null,/*#__PURE__*/React.createElement(InputGroupAddon,{addonType:\"prepend\"},/*#__PURE__*/React.createElement(Button,{type:\"button\",color:\"primary\",onClick:function onClick(){return uploadFile();}},\"Agregar\")),/*#__PURE__*/React.createElement(Input,{autoComplete:\"off\",type:\"text\",name:\"treatment_plan\",value:fileName,onChange:function onChange(e){return setFileName(e.target.value);}}),/*#__PURE__*/React.createElement(InputGroupAddon,{addonType:\"append\"},/*#__PURE__*/React.createElement(Button,{type:\"button\",color:\"primary\",onClick:function onClick(){document.getElementById('files').click();}},\"Buscar\"))),/*#__PURE__*/React.createElement(\"h5\",{align:\"right\",style:{marginRight:\"10px\",marginBottom:\"0px\"}},helpText),/*#__PURE__*/React.createElement(\"input\",{type:\"file\",accept:\"image/*, .pdf\",id:\"files\",style:{visibility:'hidden'},onChange:function onChange(e){return loadFile(e.target.files);}})))))),/*#__PURE__*/React.createElement(FormGroup,{className:\"row\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Label,{className:\"form-control-label\"},\"Diagnostico periodontal\"),/*#__PURE__*/React.createElement(Input,{defaultValue:\"\",id:\"example-text-input\",type:\"textarea\",onChange:function onChange(e){setPeriodontalDiagnosis(e.target.value);}}))),/*#__PURE__*/React.createElement(FormGroup,{className:\"row\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Label,{className:\"form-control-label\"},\"Diagnostico Odontologico\"),/*#__PURE__*/React.createElement(Input,{defaultValue:\"\",id:\"example-text-input\",type:\"textarea\",onChange:function onChange(e){setOdontologicalDiagnosis(e.target.value);}}))),/*#__PURE__*/React.createElement(FormGroup,{className:\"row\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Label,{className:\"form-control-label\"},\"Plan de tratamiento\"),/*#__PURE__*/React.createElement(Input,{defaultValue:\"\",id:\"example-text-input\",type:\"textarea\",onChange:function onChange(e){setTreatmentPlan(e.target.value);}}))),/*#__PURE__*/React.createElement(FormGroup,{className:\"row\"},/*#__PURE__*/React.createElement(Col,{md:\"10\"}),/*#__PURE__*/React.createElement(Col,{md:\"2\"},/*#__PURE__*/React.createElement(Button,{type:\"submit\",color:\"primary\"},\"Guardar\")))),next&&/*#__PURE__*/React.createElement(Redirect,{to:{pathname:\"/admin/list-patient-anamnesis\",state:{id:location.state.id,run:location.state.run,name:location.state.name,apellido:location.state.apellido,anamId:location.state.anamId,dentalAnamnesis:true}}}))));};export default Periodontogram;","map":{"version":3,"sources":["C:/Users/Christian/Desktop/tele/Nueva carpeta/src/views/pages/patient/peridontrograma.js"],"names":["React","useState","useEffect","useRef","Button","Col","Container","Form","FormGroup","Input","Row","InputGroup","InputGroupText","InputGroupAddon","Card","CardBody","Label","classnames","CardHeader","Axios","Redirect","SimpleModal","Periodontogram","location","modalRef","setModal","options","current","next","setNext","periodontalDiagnosis","setPeriodontalDiagnosis","odontologicalDiagnosis","setOdontologicalDiagnosis","treatmentPlan","setTreatmentPlan","fetchFiles","fileName","setFileName","fileType","setFileType","file","setFile","hasFile","setHasFile","files","setFiles","extAllowed","sizAllowed","defaultHelpText","helpText","setHelpText","handleHasFile","cleanFile","post","anamnId","state","anamId","res","data","error","result","loadFile","name","size","full","type","slice","lastIndexOf","toLowerCase","indexOf","uploadFile","f","FormData","append","run","then","response","saveFile","catch","console","log","nombreImagen","ruta","removeFile","fId","route","addDiagnosticos","e","preventDefault","apellido","map","foto_id","title","text","foto_nombre","fx","process","env","REACT_APP_API_URL","url","target","value","document","getElementById","click","marginRight","marginBottom","visibility","pathname","id","dentalAnamnesis"],"mappings":"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","sourcesContent":["import React, {useState, useEffect,useRef} from 'react'\r\nimport {\r\n    Button, Col, Container, Form, FormGroup, Input, Row, InputGroup,\r\n    InputGroupText, InputGroupAddon, Card, CardBody, Label\r\n} from 'reactstrap'\r\nimport classnames from \"classnames\";\r\nimport CardHeader from 'reactstrap/lib/CardHeader';\r\nimport Axios from '../../../helpers/axiosConfig'\r\nimport {Redirect} from 'react-router-dom';\r\nimport SimpleModal from \"../components/SimpleModal\";\r\n\r\nconst Periodontogram = ({location}) => {\r\n    \r\n    const modalRef = useRef()\r\n    const setModal = (options) => {\r\n        modalRef.current.setModal(options);\r\n    };\r\n    \r\n    const [next, setNext] = useState(false)\r\n    const [periodontalDiagnosis, setPeriodontalDiagnosis] = useState(\"\")\r\n    const [odontologicalDiagnosis, setOdontologicalDiagnosis] = useState(\"\")\r\n    const [treatmentPlan, setTreatmentPlan] = useState(\"\")\r\n\r\n    //LOCATION###############################################################\r\n    useEffect(() => {\r\n        fetchFiles();\r\n    }, []);\r\n   \r\n    //FILE###################################################################\r\n    const [fileName, setFileName] = useState(\"\");\r\n    const [fileType, setFileType] = useState(\"\");\r\n    const [file, setFile] = useState({});\r\n    const [hasFile, setHasFile] = useState(false);\r\n    const [files, setFiles] =useState([]);\r\n    const extAllowed = \"pdf\";\r\n    const sizAllowed = 10000000;\r\n    const defaultHelpText = extAllowed + \" (max: \" + sizAllowed / 1000000 + \" MB)\";\r\n    const [helpText, setHelpText] =useState(defaultHelpText);\r\n\r\n    const handleHasFile = () => {\r\n        setHasFile(!hasFile);\r\n        cleanFile();\r\n        setHelpText(defaultHelpText);\r\n    };\r\n\r\n    const fetchFiles= async () => {\r\n        const res = await Axios.post(\"photo/odonto_geriatra/obtain\", {anamnId: location.state.anamId})\r\n        if (!res.data.error) {\r\n            setFiles(res.data.result);\r\n            setModal({});\r\n        };       \r\n    };\r\n\r\n    const loadFile = (file) => {\r\n        if (file[0]?.name) {\r\n            const size = file[0].size;\r\n            const full = file[0]?.name;\r\n            const type = full.slice((full.lastIndexOf('.') - 1 >>> 0) + 2).toLowerCase();\r\n            if (extAllowed.indexOf(type) >= 0) {\r\n                if (size <= sizAllowed) {\r\n                    setFileName(full.slice(0, (full.lastIndexOf('.'))));\r\n                    setFileType(type);\r\n                    setFile(file);\r\n                    setHelpText(full);\r\n                    return;\r\n                } else {\r\n                    cleanFile();\r\n                    setHelpText(\"Tamaño de archivo invalido\");\r\n                    return;\r\n                };\r\n            };\r\n            cleanFile();\r\n            setHelpText(\"Formato de archivo invalido\");\r\n        };\r\n    };\r\n\r\n    const cleanFile = () => {\r\n        setFileName(\"\");\r\n        setFileType(\"\");\r\n        setFile({});\r\n    };\r\n\r\n    const uploadFile = () => {\r\n        if (fileName) {\r\n            const f = new FormData();\r\n            f.append(\"file\", file[0], fileName + '.' + fileType);\r\n            Axios.post(\"file/img_odonto/\" + location.state.run, f)\r\n            .then(response => {\r\n                saveFile();\r\n            }).catch(error => {\r\n                console.log(error);\r\n            });\r\n        };\r\n    };\r\n\r\n    const saveFile = async () => {\r\n        const res = await Axios.post(\"photo/odonto_geriatra\",\r\n            {anamnId : location.state.anamId,\r\n            nombreImagen: fileName + '.' + fileType,\r\n            ruta: \"static/images_anam_odonto/\" + location.state.run}\r\n        );\r\n        if (!res.data.error) {\r\n            fetchFiles();\r\n            cleanFile();\r\n            setHelpText(defaultHelpText);\r\n            setHasFile(false);\r\n        }; \r\n    };    \r\n\r\n    const removeFile = async (fId, name) => {\r\n        const res = await Axios.post(\"photo/odonto_geriatra/rm/\", {\r\n            fId : fId,\r\n            route : location.state.run + '/' + name\r\n        });\r\n        if (!res.data.error) {\r\n            fetchFiles();\r\n        }; \r\n    };\r\n\r\n    const addDiagnosticos = async e => {\r\n        e.preventDefault()\r\n        const res = await Axios.post(\"geriatrical-odonto-anamnesis/periodontograma\",\r\n            {\r\n                anamId: location.state.anamId,\r\n                periodontalDiagnosis:periodontalDiagnosis,\r\n                odontologicalDiagnosis:odontologicalDiagnosis,\r\n                treatmentPlan:treatmentPlan\r\n            }\r\n        );\r\n\r\n        if (!res.data.error){\r\n            setNext(true);\r\n        };  \r\n    };\r\n   \r\n    return (\r\n        <Container>\r\n            <SimpleModal ref={modalRef}/>\r\n            <Card>\r\n                <CardBody>\r\n                <h3>{location.state.run}, {location.state.name} {location.state.apellido}</h3>\r\n                    <h1>\r\n                        Anamnesis Odonto-geriátrica \r\n                    </h1>\r\n                    <h6 className=\"heading-small text-muted mb-4\">\r\n                        Periodontograma\r\n                    </h6>\r\n                    <Form  onSubmit={addDiagnosticos} role=\"form\">\r\n                    <FormGroup className=\"row\">\r\n                        <Col>\r\n                            <Label className=\"form-control-label mb-3\">Periodontograma (<a href=\"https://sepa.es/periodontograma/index.html\" target=\"_blank\">Link a SEPA</a>)</Label>\r\n                        </Col>\r\n                    </FormGroup>\r\n                    <FormGroup className=\"row\">\r\n                        <Col md=\"6\">\r\n                            <Label className=\"form-control-label mb-3\">Archivos disponibles</Label>\r\n                            {files.map((file) => (\r\n                                <div key={file.foto_id} className=\"list-group mb-2\">\r\n                                    <InputGroup>\r\n                                        <Button className=\"mr-2\" color=\"danger\" size=\"sm\" outline onClick={() => setModal({title: 'Confirmación', text: 'Desea eliminar ' + file.foto_nombre + '?', type: 2, fx: () => removeFile(file.foto_id, file.foto_nombre)})}><i className=\"far fa-trash-alt\"/></Button>\r\n                                        <a rel=\"noopener noreferrer\" target=\"_blank\" href={process.env.REACT_APP_API_URL + `${file.url}` + \"/\" + `${file.foto_nombre}`}>{file.foto_nombre}</a>\r\n                                    </InputGroup>\r\n                                </div>\r\n                            ))}\r\n                        </Col>\r\n                        <Col md=\"6\">\r\n                            <Card>\r\n                                <CardHeader>\r\n                                    <FormGroup className=\"row\">\r\n                                        <Col className=\"d-flex\">\r\n                                            <Label className=\"form-control-label\">¿Subir periodontograma?</Label>\r\n                                            <label className=\"custom-toggle custom-toggle-info ml-3\">\r\n                                                <Input type=\"checkbox\" checked={hasFile} onChange={() => handleHasFile()}/>\r\n                                                <span className=\"custom-toggle-slider rounded-circle\" data-label-off=\"No\" data-label-on=\"Sí\"/>\r\n                                            </label>\r\n                                        </Col>\r\n                                    </FormGroup>\r\n                                </CardHeader>\r\n                                {hasFile &&\r\n                                    <CardBody>\r\n                                        <FormGroup>\r\n                                            <InputGroup>\r\n                                                <InputGroupAddon addonType=\"prepend\">\r\n                                                    <Button \r\n                                                        type=\"button\" color=\"primary\"\r\n                                                        onClick={() => uploadFile()}>\r\n                                                        Agregar \r\n                                                    </Button>\r\n                                                </InputGroupAddon>\r\n                                                <Input\r\n                                                    autoComplete=\"off\"\r\n                                                    type=\"text\"\r\n                                                    name=\"treatment_plan\"\r\n                                                    value={fileName}\r\n                                                    onChange={e => setFileName(e.target.value)}\r\n                                                />\r\n                                                <InputGroupAddon addonType=\"append\">\r\n                                                    <Button \r\n                                                        type=\"button\" color=\"primary\" \r\n                                                        onClick={() => {document.getElementById('files').click()}}>\r\n                                                        Buscar\r\n                                                    </Button>\r\n                                                </InputGroupAddon>\r\n                                            </InputGroup>\r\n                                            <h5 align=\"right\" style={{marginRight: \"10px\", marginBottom: \"0px\"}}>{helpText}</h5>\r\n                                            <input \r\n                                                type=\"file\" \r\n                                                accept=\"image/*, .pdf\"\r\n                                                id=\"files\" \r\n                                                style={{visibility: 'hidden'}} \r\n                                                onChange={e => loadFile(e.target.files)}\r\n                                            />\r\n                                        </FormGroup>\r\n                                    </CardBody>\r\n                                }\r\n                            </Card>\r\n                        </Col>\r\n                    </FormGroup>  \r\n                    <FormGroup className=\"row\">\r\n                            <Col>\r\n                                <Label\r\n                                    className=\"form-control-label\"\r\n                                >\r\n                                    Diagnostico periodontal\r\n                                </Label>\r\n\r\n                                <Input\r\n                                    defaultValue=\"\"\r\n                                    id=\"example-text-input\"\r\n                                    type=\"textarea\"\r\n                                    onChange={(e) => {\r\n                                        setPeriodontalDiagnosis(e.target.value)\r\n                                    }}\r\n                                />\r\n                            </Col>\r\n                        </FormGroup>\r\n                        <FormGroup className=\"row\">\r\n                            <Col>\r\n                                <Label\r\n                                    className=\"form-control-label\"\r\n                                >\r\n                                    Diagnostico Odontologico\r\n                                </Label>\r\n\r\n                                <Input\r\n                                    defaultValue=\"\"\r\n                                    id=\"example-text-input\"\r\n                                    type=\"textarea\"\r\n                                    onChange={(e) => {\r\n                                        setOdontologicalDiagnosis(e.target.value)\r\n                                    }}\r\n                                />\r\n                            </Col>\r\n                        </FormGroup>\r\n                        <FormGroup className=\"row\">\r\n                            <Col>\r\n                                <Label\r\n                                    className=\"form-control-label\"\r\n                                >\r\n                                    Plan de tratamiento\r\n                                </Label>\r\n\r\n                                <Input\r\n                                    defaultValue=\"\"\r\n                                    id=\"example-text-input\"\r\n                                    type=\"textarea\"\r\n                                    onChange={(e) => {\r\n                                        setTreatmentPlan(e.target.value)\r\n                                    }}\r\n                                />\r\n                            </Col>\r\n                        </FormGroup>\r\n                        <FormGroup className=\"row\">\r\n                            <Col md=\"10\">\r\n                               \r\n                            </Col>\r\n                            <Col md=\"2\">\r\n                           \r\n                              <Button type=\"submit\" color=\"primary\">Guardar</Button>\r\n                             \r\n                            </Col>\r\n                        </FormGroup>\r\n                    </Form> \r\n\r\n\r\n\r\n\r\n\r\n                    { next && <Redirect to={{\r\n                    pathname: \"/admin/list-patient-anamnesis\",\r\n                    state: { id: location.state.id, run: location.state.run, name: location.state.name, apellido : location.state.apellido, anamId:location.state.anamId, dentalAnamnesis:true} \r\n                    }} /> } \r\n                </CardBody>\r\n            </Card>\r\n        </Container>\r\n    )\r\n}\r\n\r\nexport default Periodontogram\r\n"]},"metadata":{},"sourceType":"module"}