{"ast":null,"code":"import _objectSpread from\"C:\\\\Users\\\\Christian\\\\Desktop\\\\tele\\\\Nueva carpeta\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"C:\\\\Users\\\\Christian\\\\Desktop\\\\tele\\\\Nueva carpeta\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\Christian\\\\Desktop\\\\tele\\\\Nueva carpeta\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\Christian\\\\Desktop\\\\tele\\\\Nueva carpeta\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";// import \"assets/css/custom-style.css\";\nimport{Redirect}from'react-router-dom';import React,{useState,useEffect,useRef}from'react';import{Button,Col,Container,FormGroup,Input,Card,CardBody,Label,Table,Modal,ModalHeader,ModalBody,InputGroup,InputGroupAddon}from'reactstrap';import{getList}from'helpers/ListHelper';import moment from'moment';import axios from'../../../helpers/axiosConfig';import SimpleModal from\"../components/SimpleModal\";var Referral=function Referral(_ref){var _location$state,_location$state2;var location=_ref.location;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),cleanLocation=_useState2[0],setCleanLocation=_useState2[1];var l_run=\"\";if(location===null||location===void 0?void 0:(_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.run){l_run=location.state.run;}var _useState3=useState(l_run),_useState4=_slicedToArray(_useState3,2),searchTermPerson=_useState4[0],setSearchTermPerson=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),persons=_useState8[0],setPersons=_useState8[1];var _useState9=useState({}),_useState10=_slicedToArray(_useState9,2),person=_useState10[0],setPerson=_useState10[1];var fetchPersons=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getList(\"list/person\");case 2:res=_context.sent;setLoading(false);setPersons(res);case 5:case\"end\":return _context.stop();}}},_callee);}));return function fetchPersons(){return _ref2.apply(this,arguments);};}();useEffect(function(){setTimeout(fetchPersons,1000);return function(){setCleanLocation(true);};},[]);var modalRef=useRef();var setSimpleModal=function setSimpleModal(options){modalRef.current.setModal(options);};/*Referrals###############################################################################*/var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),displayModalReferrals=_useState12[0],setDisplayModalReferrals=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),referrals=_useState14[0],setReferrals=_useState14[1];var showModalReferrals=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(person){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setPerson(person);fetchReferrals(person.person_id);setDisplayModalReferrals(!displayModalReferrals);case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function showModalReferrals(_x){return _ref3.apply(this,arguments);};}();var fetchReferrals=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(person_id){var res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return getList(\"referral/\"+person_id);case 2:res=_context3.sent;setReferrals(res);case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function fetchReferrals(_x2){return _ref4.apply(this,arguments);};}();/*Referrals###############################################################################*/ /*Professionals###########################################################################*/var defaultProfessional={professional_id:0,professional_fullname:\"\",professional_run:\"\",professional_email:\"\",professional_medical_area_id:0,professional_medical_area_name:\"\"};var _useState15=useState(defaultProfessional),_useState16=_slicedToArray(_useState15,2),professional=_useState16[0],setProfessional=_useState16[1];var _useState17=useState([]),_useState18=_slicedToArray(_useState17,2),professionals=_useState18[0],setProfessionals=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),displayModalProfessionals=_useState20[0],setDisplayModalProfessionals=_useState20[1];var _useState21=useState(\"\"),_useState22=_slicedToArray(_useState21,2),searchTermProfessional=_useState22[0],setSearchTermProfessional=_useState22[1];var showModalProfessionals=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:fetchProfessionals();setDisplayModalProfessionals(!displayModalProfessionals);setSearchTermProfessional(\"\");case 3:case\"end\":return _context4.stop();}}},_callee4);}));return function showModalProfessionals(){return _ref5.apply(this,arguments);};}();var obtener=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(professional){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:setProfessional(professional);setDisplayModalProfessionals(!displayModalProfessionals);case 2:case\"end\":return _context5.stop();}}},_callee5);}));return function obtener(_x3){return _ref6.apply(this,arguments);};}();var fetchProfessionals=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var res;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return getList(\"user/user-professional\");case 2:res=_context6.sent;setProfessionals(res);case 4:case\"end\":return _context6.stop();}}},_callee6);}));return function fetchProfessionals(){return _ref7.apply(this,arguments);};}();/*Professionals###########################################################################*/ /*Referral################################################################################*/var defaultReferral={referral_id:0,referral_description:\"\"};var _useState23=useState(false),_useState24=_slicedToArray(_useState23,2),displayModalReferral=_useState24[0],setDisplayModalReferral=_useState24[1];var _useState25=useState(defaultReferral),_useState26=_slicedToArray(_useState25,2),referral=_useState26[0],setReferral=_useState26[1];var showModalReferralToCreate=function showModalReferralToCreate(person){setPerson(person);setReferral(defaultReferral);setProfessional(defaultProfessional);setDisplayModalReferral(!displayModalReferral);};var showModalReferralToUpdate=function showModalReferralToUpdate(referral){setReferral(referral);setProfessional(referral);setDisplayModalReferral(!displayModalReferral);};var handleInputChangeReferral=function handleInputChangeReferral(e){setReferral(_objectSpread(_objectSpread({},referral),{},{[e.target.name]:e.target.value}));};/*Referral################################################################################*/ /*Crud####################################################################################*/var disableReferral=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(id){return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return axios.put(\"referral/\"+id);case 2:setSimpleModal({});fetchReferrals(person.person_id);case 4:case\"end\":return _context7.stop();}}},_callee7);}));return function disableReferral(_x4){return _ref8.apply(this,arguments);};}();var updateReferral=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(){var res;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.prev=0;_context8.next=3;return axios.post(\"referral/\"+referral.referral_id,{professional_id:professional.professional_id,professional_medical_area_id:professional.professional_medical_area_id,referral_description:referral.referral_description});case 3:res=_context8.sent;if(!res.data.error){setDisplayModalReferral(!displayModalReferral);fetchReferrals(person.person_id);}else{console.log('Err: '+res.data.result.code+' '+res.data.result.sqlMessage);};_context8.next=11;break;case 8:_context8.prev=8;_context8.t0=_context8[\"catch\"](0);console.log('Err: '+_context8.t0);case 11:;case 12:case\"end\":return _context8.stop();}}},_callee8,null,[[0,8]]);}));return function updateReferral(){return _ref9.apply(this,arguments);};}();var emailBody=\"\\n        <html>\\n            <h2>Interconsulta</h2>\\n            <ul>\\n                <li>Paciente: \".concat(person.names+' '+person.lastnames,\"</li>\\n                <li>Rut: \").concat(person.run,\"</li>\\n                <li>Profesional: \").concat(professional.professional_fullname,\"</li>\\n                <li>Area: \").concat(professional.professional_medical_area_name,\"</li>\\n                <li>Descripcion: \").concat(referral.referral_description,\"</li>\\n            </ul>\\n            <br></br>\\n            <em>Este email fue generado automaticamente, por favor no responder</em>\\n        </html>    \\n    \");var saveReferral=/*#__PURE__*/function(){var _ref10=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(){var res;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.prev=0;_context9.next=3;return axios.post(process.env.REACT_APP_API_URL+\"referral\",{person_id:person.person_id,professional_id:professional.professional_id,professional_medical_area_id:professional.professional_medical_area_id,referral_description:referral.referral_description,professional_email:professional.professional_email,emailBody:emailBody});case 3:res=_context9.sent;if(!res.data.error){setDisplayModalReferral(!displayModalReferral);}else{console.log('Err: '+res.data.result.code+' '+res.data.result.sqlMessage);};_context9.next=11;break;case 8:_context9.prev=8;_context9.t0=_context9[\"catch\"](0);console.log('Err: '+_context9.t0);case 11:;case 12:case\"end\":return _context9.stop();}}},_callee9,null,[[0,8]]);}));return function saveReferral(){return _ref10.apply(this,arguments);};}();/*Crud####################################################################################*/return/*#__PURE__*/React.createElement(Container,{className:\"mt-3\"},/*#__PURE__*/React.createElement(SimpleModal,{ref:modalRef}),/*#__PURE__*/React.createElement(Card,null,/*#__PURE__*/React.createElement(CardBody,null,(location===null||location===void 0?void 0:(_location$state2=location.state)===null||_location$state2===void 0?void 0:_location$state2.run)&&/*#__PURE__*/React.createElement(\"h3\",null,location.state.run,\", \",location.state.name,\" \",location.state.apellido),/*#__PURE__*/React.createElement(\"h1\",null,\"Interconsulta\"),/*#__PURE__*/React.createElement(Input,{type:\"text\",placeholder:\"Buscar paciente...\",value:searchTermPerson,onChange:function onChange(e){return setSearchTermPerson(e.target.value);}}),/*#__PURE__*/React.createElement(\"br\",null),loading?/*#__PURE__*/React.createElement(\"div\",{className:\"w-100 d-flex justify-content-center\"},/*#__PURE__*/React.createElement(\"div\",{className:\"loader\"})):/*#__PURE__*/React.createElement(Table,{className:\"align-items-center\",responsive:true},/*#__PURE__*/React.createElement(\"thead\",{className:\"thead-light\"},/*#__PURE__*/React.createElement(\"tr\",{className:\"text-center\"},/*#__PURE__*/React.createElement(\"th\",{scope:\"col\"},\"Run\"),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\"},\"Nombre\"),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\"},\"Apellidos\"),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\"}),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\"}))),/*#__PURE__*/React.createElement(\"tbody\",null,persons.filter(function(val){if(searchTermPerson==\"\"){return val;}else if(val.run.includes(searchTermPerson)||val.fullname.toLowerCase().includes(searchTermPerson.toLowerCase())){return val;}}).map(function(e_person){return/*#__PURE__*/React.createElement(\"tr\",{className:\"text-center\",key:e_person.person_id},/*#__PURE__*/React.createElement(\"td\",null,e_person.run),/*#__PURE__*/React.createElement(\"td\",null,e_person.names),/*#__PURE__*/React.createElement(\"td\",null,e_person.lastnames),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(Button,{color:\"primary\",onClick:function onClick(){return showModalReferralToCreate(e_person);}},\"Nuevo\")),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(Button,{onClick:function onClick(){return showModalReferrals(e_person);}},\"Listado\")));}))))),/*#__PURE__*/React.createElement(Modal,{isOpen:displayModalReferral},/*#__PURE__*/React.createElement(ModalHeader,{toggle:function toggle(){setDisplayModalReferral(!displayModalReferral);}},\"Interconsulta\"),/*#__PURE__*/React.createElement(ModalBody,{className:\"pt-1\"},/*#__PURE__*/React.createElement(FormGroup,{className:\"row\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Label,{className:\"form-control-label\"},\"Profesional\"),/*#__PURE__*/React.createElement(InputGroup,null,/*#__PURE__*/React.createElement(Input,{style:{backgroundColor:\"white\"},readOnly:true,type:\"text\",name:\"referral_user_fullname\",value:professional.professional_fullname}),/*#__PURE__*/React.createElement(InputGroupAddon,{addonType:\"append\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-search btn btn-primary\",onClick:function onClick(){return showModalProfessionals();}}))))),/*#__PURE__*/React.createElement(FormGroup,{className:\"row\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Label,{className:\"form-control-label\"},\"\\xC1rea de Especialidad Odontol\\xF3gica/M\\xE9dica\"),/*#__PURE__*/React.createElement(Input,{style:{backgroundColor:\"white\"},readOnly:true,type:\"text\",name:\"professional_medical_area_name\",value:professional.professional_medical_area_name}))),/*#__PURE__*/React.createElement(FormGroup,{className:\"row\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Label,{className:\"form-control-label\"},\"Email\"),/*#__PURE__*/React.createElement(Input,{style:{backgroundColor:\"white\"},readOnly:true,type:\"email\",name:\"professional_email\",value:professional.professional_email}))),/*#__PURE__*/React.createElement(FormGroup,{className:\"row\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Label,{className:\"form-control-label\"},\"Descripci\\xF3n\"),/*#__PURE__*/React.createElement(Input,{autoComplete:\"off\",maxLength:\"250\",type:\"textarea\",name:\"referral_description\",value:referral.referral_description,onChange:function onChange(e){return handleInputChangeReferral(e);}}))),/*#__PURE__*/React.createElement(\"div\",{className:\"float-right mb-2 mr-2\"},referral.referral_id==0?/*#__PURE__*/React.createElement(Button,{color:\"primary\",onClick:function onClick(){saveReferral();}},\"Guardar\"):/*#__PURE__*/React.createElement(Button,{color:\"primary\",onClick:function onClick(){updateReferral();}},\"Editar\")))),/*#__PURE__*/React.createElement(Modal,{size:\"lg\",isOpen:displayModalProfessionals},/*#__PURE__*/React.createElement(ModalHeader,{toggle:function toggle(){setDisplayModalProfessionals(!displayModalProfessionals);}},\"Interconsulta\"),/*#__PURE__*/React.createElement(ModalBody,{className:\"pt-1\"},/*#__PURE__*/React.createElement(Input,{type:\"text\",placeholder:\"Buscar profesional...\",value:searchTermProfessional,onChange:function onChange(e){return setSearchTermProfessional(e.target.value);}}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(Table,{className:\"align-items-center\",responsive:true},/*#__PURE__*/React.createElement(\"thead\",{className:\"thead-light\"},/*#__PURE__*/React.createElement(\"tr\",{className:\"text-center\"},/*#__PURE__*/React.createElement(\"th\",{scope:\"col\"},\"Profesional\"),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\"},\"\\xC1rea de Especialidad\"),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\"},\"Email\"),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\"}))),/*#__PURE__*/React.createElement(\"tbody\",null,professionals.filter(function(val){if(searchTermProfessional==\"\"){return val;}else if(val.professional_run.includes(searchTermProfessional)||val.professional_fullname.toLowerCase().includes(searchTermProfessional.toLowerCase())||val.professional_medical_area_name.toLowerCase().includes(searchTermProfessional.toLowerCase())){return val;}}).map(function(professional){return/*#__PURE__*/React.createElement(\"tr\",{className:\"text-center\",key:professional.professional_id+''+professional.professional_medical_area_id},/*#__PURE__*/React.createElement(\"td\",null,professional.professional_fullname),/*#__PURE__*/React.createElement(\"td\",null,professional.professional_medical_area_name),/*#__PURE__*/React.createElement(\"td\",null,professional.professional_email),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(Button,{onClick:function onClick(){return obtener(professional);},color:\"primary\"},\"Seleccionar\")));}))))),/*#__PURE__*/React.createElement(Modal,{size:\"lg\",isOpen:displayModalReferrals},/*#__PURE__*/React.createElement(ModalHeader,{toggle:function toggle(){setDisplayModalReferrals(!displayModalReferrals);}},\"Interconsulta\"),/*#__PURE__*/React.createElement(ModalBody,{className:\"pt-1\"},/*#__PURE__*/React.createElement(Table,{className:\"align-items-center\",responsive:true},/*#__PURE__*/React.createElement(\"thead\",{className:\"thead-light\"},/*#__PURE__*/React.createElement(\"tr\",{className:\"text-center\"},/*#__PURE__*/React.createElement(\"th\",{scope:\"col\"},\"Fecha Creacion\"),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\"},\"Profesional\"),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\"},\"\\xC1rea de Especialidad\"),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\"}),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\"}))),/*#__PURE__*/React.createElement(\"tbody\",null,referrals.map(function(referral){return/*#__PURE__*/React.createElement(\"tr\",{className:\"text-center\",key:referral.referral_id},/*#__PURE__*/React.createElement(\"td\",null,moment(referral.referral_created_date).format('DD-MM-YYYY')),/*#__PURE__*/React.createElement(\"td\",null,referral.professional_fullname),/*#__PURE__*/React.createElement(\"td\",null,referral.professional_medical_area_name),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(Button,{color:\"primary\",onClick:function onClick(){return showModalReferralToUpdate(referral);}},\"Editar\")),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(Button,{onClick:function onClick(){return setSimpleModal({title:'Interconsulta',text:'¿Desea eliminar la interconsulta con el profesional '+referral.professional_fullname+'?',type:2,fx:function fx(){return disableReferral(referral.referral_id);}});}},\"Eliminar\")));}))))),cleanLocation&&/*#__PURE__*/React.createElement(Redirect,{to:{pathname:\"/admin/consultation-referral\",state:{}}}));};export default Referral;","map":{"version":3,"sources":["C:/Users/Christian/Desktop/tele/Nueva carpeta/src/views/pages/patient/referral.js"],"names":["Redirect","React","useState","useEffect","useRef","Button","Col","Container","FormGroup","Input","Card","CardBody","Label","Table","Modal","ModalHeader","ModalBody","InputGroup","InputGroupAddon","getList","moment","axios","SimpleModal","Referral","location","cleanLocation","setCleanLocation","l_run","state","run","searchTermPerson","setSearchTermPerson","loading","setLoading","persons","setPersons","person","setPerson","fetchPersons","res","setTimeout","modalRef","setSimpleModal","options","current","setModal","displayModalReferrals","setDisplayModalReferrals","referrals","setReferrals","showModalReferrals","fetchReferrals","person_id","defaultProfessional","professional_id","professional_fullname","professional_run","professional_email","professional_medical_area_id","professional_medical_area_name","professional","setProfessional","professionals","setProfessionals","displayModalProfessionals","setDisplayModalProfessionals","searchTermProfessional","setSearchTermProfessional","showModalProfessionals","fetchProfessionals","obtener","defaultReferral","referral_id","referral_description","displayModalReferral","setDisplayModalReferral","referral","setReferral","showModalReferralToCreate","showModalReferralToUpdate","handleInputChangeReferral","e","target","name","value","disableReferral","id","put","updateReferral","post","data","error","console","log","result","code","sqlMessage","emailBody","names","lastnames","saveReferral","process","env","REACT_APP_API_URL","apellido","filter","val","includes","fullname","toLowerCase","map","e_person","backgroundColor","referral_created_date","format","title","text","type","fx","pathname"],"mappings":"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","sourcesContent":["// import \"assets/css/custom-style.css\";\r\nimport {Redirect} from 'react-router-dom';\r\nimport React, {useState, useEffect, useRef} from 'react';\r\nimport {Button, Col, Container, FormGroup, Input, Card, CardBody, Label, Table, Modal, ModalHeader, ModalBody, InputGroup, InputGroupAddon} from 'reactstrap';\r\nimport {getList} from 'helpers/ListHelper';\r\nimport moment from 'moment';\r\nimport axios from '../../../helpers/axiosConfig';\r\nimport SimpleModal from \"../components/SimpleModal\";\r\n\r\nconst Referral = ({location}) => {\r\n\r\n    const [cleanLocation, setCleanLocation] = useState(false)\r\n    let l_run = \"\"\r\n    if(location?.state?.run) {\r\n        l_run = location.state.run;\r\n    }\r\n    \r\n    const [searchTermPerson, setSearchTermPerson] = useState(l_run);\r\n    const [loading, setLoading] = useState(true);\r\n    const [persons, setPersons] = useState([]);\r\n    const [person, setPerson] = useState({});\r\n\r\n    const fetchPersons = async () => {\r\n        const res = await getList(\"list/person\");\r\n        setLoading(false)\r\n        setPersons(res);\r\n    };\r\n\r\n    useEffect(() => { \r\n        setTimeout(fetchPersons, 1000);\r\n        return () => {\r\n            setCleanLocation(true);\r\n        }\r\n    }, []);\r\n\r\n    const modalRef = useRef()\r\n    const setSimpleModal = (options) => {\r\n        modalRef.current.setModal(options);\r\n    };\r\n\r\n    /*Referrals###############################################################################*/ \r\n    const [displayModalReferrals, setDisplayModalReferrals] = useState(false);\r\n    const [referrals, setReferrals] = useState([]);\r\n    const showModalReferrals = async (person) => {\r\n        setPerson(person);\r\n        fetchReferrals(person.person_id);\r\n        setDisplayModalReferrals(!displayModalReferrals);\r\n    }\r\n    const fetchReferrals = async person_id => {\r\n        const res = await getList(\"referral/\" + person_id);\r\n        setReferrals(res);\r\n    };  \r\n    /*Referrals###############################################################################*/ \r\n\r\n    /*Professionals###########################################################################*/ \r\n    const defaultProfessional = {professional_id: 0, professional_fullname: \"\", professional_run: \"\", professional_email: \"\", professional_medical_area_id: 0, professional_medical_area_name: \"\"};\r\n    const [professional, setProfessional] = useState(defaultProfessional);\r\n    const [professionals, setProfessionals] = useState([]);\r\n\r\n    const [displayModalProfessionals, setDisplayModalProfessionals] = useState(false);\r\n    const [searchTermProfessional, setSearchTermProfessional] = useState(\"\");\r\n\r\n    const showModalProfessionals = async () => {\r\n        fetchProfessionals();\r\n        setDisplayModalProfessionals(!displayModalProfessionals);\r\n        setSearchTermProfessional(\"\");\r\n    }\r\n\r\n    const obtener = async professional => {\r\n        setProfessional(professional)\r\n        setDisplayModalProfessionals(!displayModalProfessionals);\r\n    };\r\n\r\n    const fetchProfessionals = async () => {\r\n        const res = await getList(\"user/user-professional\");\r\n        setProfessionals(res);\r\n    };\r\n    /*Professionals###########################################################################*/ \r\n\r\n    /*Referral################################################################################*/\r\n    const defaultReferral = {referral_id: 0, referral_description: \"\"};\r\n    const [displayModalReferral, setDisplayModalReferral] = useState(false);\r\n    const [referral, setReferral] = useState(defaultReferral);\r\n    \r\n    const showModalReferralToCreate = (person) => {\r\n        setPerson(person);\r\n        setReferral(defaultReferral);\r\n        setProfessional(defaultProfessional);\r\n        setDisplayModalReferral(!displayModalReferral);\r\n    };\r\n\r\n    const showModalReferralToUpdate = referral => {\r\n        setReferral(referral);\r\n        setProfessional(referral);\r\n        setDisplayModalReferral(!displayModalReferral);\r\n    };\r\n\r\n    const handleInputChangeReferral = e => {\r\n        setReferral({\r\n            ...referral,\r\n            [e.target.name]: e.target.value\r\n        });\r\n    };\r\n    /*Referral################################################################################*/ \r\n    \r\n    /*Crud####################################################################################*/ \r\n    const disableReferral = async id => {\r\n        await axios.put(\"referral/\" + id);\r\n        setSimpleModal({})\r\n        fetchReferrals(person.person_id);\r\n    };\r\n\r\n    const updateReferral = async () => {\r\n        try {\r\n            const res = await axios.post(\"referral/\" + referral.referral_id,\r\n            {   professional_id: professional.professional_id, \r\n                professional_medical_area_id: professional.professional_medical_area_id, \r\n                referral_description: referral.referral_description\r\n            });\r\n            if (!res.data.error) {\r\n                setDisplayModalReferral(!displayModalReferral);\r\n                fetchReferrals(person.person_id);\r\n            } else {\r\n                console.log('Err: ' + res.data.result.code + ' ' + res.data.result.sqlMessage);\r\n            };\r\n        } catch(e) {\r\n            console.log('Err: ' + e);\r\n        };\r\n    };\r\n\r\n    const emailBody = \r\n    `\r\n        <html>\r\n            <h2>Interconsulta</h2>\r\n            <ul>\r\n                <li>Paciente: ${person.names + ' ' + person.lastnames}</li>\r\n                <li>Rut: ${person.run}</li>\r\n                <li>Profesional: ${professional.professional_fullname}</li>\r\n                <li>Area: ${professional.professional_medical_area_name}</li>\r\n                <li>Descripcion: ${referral.referral_description}</li>\r\n            </ul>\r\n            <br></br>\r\n            <em>Este email fue generado automaticamente, por favor no responder</em>\r\n        </html>    \r\n    `\r\n    const saveReferral = async () => {\r\n        try {\r\n            const res = await axios.post(process.env.REACT_APP_API_URL + \"referral\",\r\n            {   person_id: person.person_id,\r\n                professional_id: professional.professional_id, \r\n                professional_medical_area_id: professional.professional_medical_area_id, \r\n                referral_description: referral.referral_description,\r\n                professional_email: professional.professional_email,\r\n                emailBody: emailBody\r\n            });\r\n            if (!res.data.error) {\r\n                setDisplayModalReferral(!displayModalReferral);\r\n            } else {\r\n                console.log('Err: ' + res.data.result.code + ' ' + res.data.result.sqlMessage);\r\n            };\r\n        } catch(e) {\r\n            console.log('Err: ' + e);\r\n        };\r\n    };\r\n    /*Crud####################################################################################*/ \r\n\r\n    return (\r\n        <Container className=\"mt-3\">\r\n            <SimpleModal ref={modalRef}/>\r\n            <Card>\r\n                <CardBody>\r\n                    {location?.state?.run && <h3>{location.state.run}, {location.state.name} {location.state.apellido}</h3>}\r\n                    <h1>Interconsulta</h1>\r\n                    <Input \r\n                        type=\"text\" \r\n                        placeholder=\"Buscar paciente...\"\r\n                        value={searchTermPerson}\r\n                        onChange={e => setSearchTermPerson(e.target.value)}\r\n                    />\r\n                    <br/>\r\n                    {loading \r\n                        ?<div className=\"w-100 d-flex justify-content-center\">\r\n                            <div className=\"loader\"></div>\r\n                        </div>\r\n                        :<Table className=\"align-items-center\" responsive>\r\n                            <thead className=\"thead-light\">\r\n                                <tr className=\"text-center\">\r\n                                    <th scope=\"col\">Run</th>\r\n                                    <th scope=\"col\">Nombre</th>\r\n                                    <th scope=\"col\">Apellidos</th>    \r\n                                    <th scope=\"col\"></th>\r\n                                    <th scope=\"col\"></th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                {persons.filter(val => {\r\n                                    if(searchTermPerson == \"\") {\r\n                                        return val;\r\n                                    } else if (val.run.includes(searchTermPerson) || val.fullname.toLowerCase().includes(searchTermPerson.toLowerCase())) {\r\n                                        return val;\r\n                                    }\r\n                                }).map(e_person => (\r\n                                    <tr className=\"text-center\" key={e_person.person_id}>\r\n                                        <td>{e_person.run}</td>\r\n                                        <td>{e_person.names}</td>\r\n                                        <td>{e_person.lastnames}</td>\r\n                                        <td>\r\n                                            <Button color=\"primary\" onClick={() => showModalReferralToCreate(e_person)}>Nuevo</Button>\r\n                                        </td>\r\n                                        <td>\r\n                                            <Button onClick={() => showModalReferrals(e_person)}>Listado</Button>\r\n                                        </td>                                    \r\n                                    </tr>\r\n                                ))}\r\n                            </tbody>\r\n                        </Table>\r\n                    }\r\n                </CardBody>\r\n            </Card>\r\n            <Modal isOpen={displayModalReferral}>\r\n                <ModalHeader toggle={() => {setDisplayModalReferral(!displayModalReferral)}}>\r\n                    Interconsulta\r\n                </ModalHeader>\r\n                <ModalBody className= \"pt-1\">\r\n                    <FormGroup className=\"row\">\r\n                        <Col>\r\n                            <Label className=\"form-control-label\">Profesional</Label>\r\n                            <InputGroup>\r\n                                <Input\r\n                                    style={{backgroundColor: \"white\"}}\r\n                                    readOnly\r\n                                    type=\"text\"\r\n                                    name=\"referral_user_fullname\"\r\n                                    value={professional.professional_fullname}\r\n                                />\r\n                                <InputGroupAddon addonType=\"append\">\r\n                                    <i className=\"fas fa-search btn btn-primary\" onClick={() => showModalProfessionals()}></i>\r\n                                </InputGroupAddon>\r\n                            </InputGroup>\r\n                        </Col>\r\n                    </FormGroup>\r\n                    <FormGroup className=\"row\">\r\n                        <Col>\r\n                            <Label className=\"form-control-label\">Área de Especialidad Odontológica/Médica</Label>\r\n                            <Input \r\n                                style={{backgroundColor: \"white\"}}\r\n                                readOnly\r\n                                type=\"text\"\r\n                                name=\"professional_medical_area_name\"\r\n                                value={professional.professional_medical_area_name}\r\n                            />\r\n                        </Col>\r\n                    </FormGroup>\r\n                    <FormGroup className=\"row\">\r\n                        <Col>\r\n                            <Label className=\"form-control-label\">Email</Label>\r\n                            <Input \r\n                                style={{backgroundColor: \"white\"}}\r\n                                readOnly\r\n                                type=\"email\"\r\n                                name=\"professional_email\"\r\n                                value={professional.professional_email}\r\n                            />\r\n                        </Col>\r\n                    </FormGroup>\r\n                    <FormGroup className=\"row\">\r\n                        <Col>\r\n                            <Label className=\"form-control-label\">Descripción</Label>\r\n                            <Input \r\n                                autoComplete=\"off\" maxLength=\"250\"\r\n                                type=\"textarea\"\r\n                                name=\"referral_description\"\r\n                                value={referral.referral_description}\r\n                                onChange={e => handleInputChangeReferral(e)}\r\n                            />\r\n                        </Col>\r\n                    </FormGroup>\r\n                    <div className= \"float-right mb-2 mr-2\">\r\n                        {referral.referral_id == 0 \r\n                            ? <Button color=\"primary\" onClick={() => {saveReferral()}}>Guardar</Button>\r\n                            : <Button color=\"primary\" onClick={() => {updateReferral()}}>Editar</Button>\r\n                        }\r\n                    </div>\r\n                </ModalBody>\r\n            </Modal>\r\n            <Modal size=\"lg\" isOpen={displayModalProfessionals}>\r\n                <ModalHeader toggle={() => {setDisplayModalProfessionals(!displayModalProfessionals)}}>\r\n                    Interconsulta\r\n                </ModalHeader>\r\n                <ModalBody className= \"pt-1\">\r\n                    <Input \r\n                        type=\"text\" \r\n                        placeholder=\"Buscar profesional...\"\r\n                        value={searchTermProfessional}\r\n                        onChange={e => setSearchTermProfessional(e.target.value)}\r\n                    />\r\n                    <br/>\r\n                    <Table className=\"align-items-center\" responsive>\r\n                        <thead className=\"thead-light\">\r\n                            <tr className=\"text-center\">\r\n                                <th scope=\"col\">Profesional</th>\r\n                                <th scope=\"col\">Área de Especialidad</th>\r\n                                <th scope=\"col\">Email</th>\r\n                                <th scope=\"col\"></th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            {professionals.filter(val => {\r\n                                if(searchTermProfessional == \"\") {\r\n                                    return val;\r\n                                } else if (val.professional_run.includes(searchTermProfessional) || val.professional_fullname.toLowerCase().includes(searchTermProfessional.toLowerCase()) || val.professional_medical_area_name.toLowerCase().includes(searchTermProfessional.toLowerCase())) {\r\n                                    return val;\r\n                                }\r\n                            }).map(professional => (\r\n                                <tr className=\"text-center\" key={professional.professional_id + '' + professional.professional_medical_area_id}>\r\n                                    <td>{professional.professional_fullname}</td>\r\n                                    <td>{professional.professional_medical_area_name}</td>\r\n                                    <td>{professional.professional_email}</td>\r\n                                    <td>\r\n                                        <Button onClick={() => obtener(professional)} color=\"primary\">Seleccionar</Button>\r\n                                    </td>\r\n                                </tr>\r\n                            ))}\r\n                        </tbody>\r\n                    </Table>\r\n                </ModalBody>\r\n            </Modal>\r\n            <Modal size=\"lg\" isOpen={displayModalReferrals}>\r\n                <ModalHeader toggle={() => {setDisplayModalReferrals(!displayModalReferrals)}}>\r\n                    Interconsulta\r\n                </ModalHeader>\r\n                <ModalBody className= \"pt-1\">\r\n                    <Table className=\"align-items-center\" responsive>\r\n                        <thead className=\"thead-light\">\r\n                            <tr className=\"text-center\">\r\n                                <th scope=\"col\">Fecha Creacion</th>\r\n                                <th scope=\"col\">Profesional</th>\r\n                                <th scope=\"col\">Área de Especialidad</th>\r\n                                <th scope=\"col\"></th>\r\n                                <th scope=\"col\"></th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            {referrals.map(referral => (\r\n                                <tr className=\"text-center\" key={referral.referral_id}>\r\n                                    <td>{moment(referral.referral_created_date).format('DD-MM-YYYY')}</td>\r\n                                    <td>{referral.professional_fullname}</td>\r\n                                    <td>{referral.professional_medical_area_name}</td>\r\n                                    <td>\r\n                                        <Button color=\"primary\" onClick={() => showModalReferralToUpdate(referral)}>Editar</Button>\r\n                                    </td>\r\n                                    <td>\r\n                                        <Button onClick={() => setSimpleModal({title: 'Interconsulta', text : '¿Desea eliminar la interconsulta con el profesional ' + referral.professional_fullname + '?', type: 2, fx: () => disableReferral(referral.referral_id)})}>Eliminar</Button>\r\n                                    </td>\r\n                                </tr>\r\n                            ))}\r\n                        </tbody>\r\n                    </Table>\r\n                </ModalBody>\r\n            </Modal>\r\n            {cleanLocation && \r\n                <Redirect to={\r\n                    {pathname: \"/admin/consultation-referral\",\r\n                    state: {}}\r\n                }/> \r\n            }\r\n        </Container>\r\n    );\r\n};\r\n\r\nexport default Referral;"]},"metadata":{},"sourceType":"module"}